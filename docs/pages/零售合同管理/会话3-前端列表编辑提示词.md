# é›¶å”®åˆåŒç®¡ç†æ¨¡å— - ä¼šè¯3ï¼šå‰ç«¯åˆ—è¡¨å’Œç¼–è¾‘åŠŸèƒ½

## ğŸ“‹ ä¼šè¯ç›®æ ‡

å®Œæˆé›¶å”®åˆåŒç®¡ç†æ¨¡å—çš„å‰ç«¯åˆ—è¡¨é¡µé¢å’Œç¼–è¾‘å¯¹è¯æ¡†ï¼Œå®ç°ä¸åç«¯APIçš„å®Œæ•´é›†æˆã€‚

**é¢„è®¡å·¥æ—¶**ï¼š2-3å°æ—¶

**å‰ç½®æ¡ä»¶**ï¼š
- ä¼šè¯1å’Œä¼šè¯2å·²å®Œæˆ
- åç«¯APIæ­£å¸¸å·¥ä½œï¼ˆåŒ…æ‹¬å¯¼å…¥å¯¼å‡ºï¼‰
- å‰ç«¯å¼€å‘ç¯å¢ƒå·²é…ç½®

---

## âš ï¸ å¼€å§‹å‰å¿…è¯»

åœ¨ç¼–å†™ä»»ä½•ä»£ç ä¹‹å‰ï¼Œè¯·ç¡®è®¤ï¼š

1. âœ… ä¼šè¯1å’Œ2å·²å®Œæˆå¹¶é€šè¿‡æ‰€æœ‰éªŒæ”¶æ ‡å‡†
2. âœ… åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œï¼ˆhttp://127.0.0.1:8005ï¼‰
3. âœ… å‰ç«¯å¼€å‘æœåŠ¡å™¨å¯ä»¥æ­£å¸¸å¯åŠ¨
4. âœ… å·²é˜…è¯» `docs/å‰ç«¯é¡µé¢è®¾è®¡è§„èŒƒ.md`
5. âœ… å·²é˜…è¯» `CLAUDE.md` ä¸­çš„å‰ç«¯å¼€å‘è§„èŒƒ

---

## ğŸ” ç¬¬ä¸€æ­¥ï¼šå¼ºåˆ¶ä»£ç åˆ†æï¼ˆå¿…é¡»å®Œæˆï¼‰

**é‡è¦æç¤º**ï¼šç¦æ­¢ç›´æ¥å¼€å§‹ç¼–ç ï¼å¿…é¡»å…ˆåˆ†æå‚è€ƒæ¨¡å—çš„å‰ç«¯å®é™…ä»£ç å®ç°ã€‚

### ä»»åŠ¡1ï¼šåˆ†æé›¶å”®å¥—é¤æ¨¡å—çš„åˆ—è¡¨é¡µé¢

**è¯·ä¾æ¬¡è¯»å–å¹¶åˆ†æä»¥ä¸‹æ–‡ä»¶**ï¼š

```
frontend/src/pages/RetailPackagePage.tsx
```

**åˆ†æé‡ç‚¹å¹¶å›ç­”ä»¥ä¸‹é—®é¢˜**ï¼š

**å…³äºé¡µé¢ç»“æ„**ï¼š
- [ ] å¤–å±‚å®¹å™¨ä½¿ç”¨ä»€ä¹ˆç»„ä»¶ï¼Ÿï¼ˆ`<Box>`ï¼Ÿ`<Container>`ï¼Ÿï¼‰
- [ ] å¤–å±‚å®¹å™¨çš„ `sx` å±æ€§æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ`width: '100%'`ï¼Ÿï¼‰
- [ ] é¢åŒ…å±‘å¯¼èˆªæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿä½¿ç”¨ä»€ä¹ˆç»„ä»¶ï¼Ÿ
- [ ] é¢åŒ…å±‘çš„æ ·å¼æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ`fontSize`ã€`fontWeight` ç­‰ï¼‰
- [ ] æ˜¯å¦æœ‰é¡µé¢ä¸»æ ‡é¢˜ï¼Ÿå¦‚æœæœ‰ï¼Œä½¿ç”¨ä»€ä¹ˆç»„ä»¶å’Œæ ·å¼ï¼Ÿ

**å…³äºæŸ¥è¯¢åŒºåŸŸ**ï¼š
- [ ] æŸ¥è¯¢å¡ç‰‡ä½¿ç”¨ä»€ä¹ˆç»„ä»¶ï¼Ÿï¼ˆ`Paper`ï¼Ÿï¼‰
- [ ] `Paper` çš„ `variant` æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ`outlined`ï¼Ÿ`elevation`ï¼Ÿï¼‰
- [ ] å†…è¾¹è·çš„å“åº”å¼è®¾ç½®ï¼Ÿï¼ˆ`p: { xs: 1, sm: 2 }`ï¼Ÿï¼‰
- [ ] æŸ¥è¯¢å­—æ®µçš„å¸ƒå±€æ–¹å¼ï¼Ÿï¼ˆ`Grid`ï¼Ÿ`Box`ï¼Ÿï¼‰
- [ ] æŒ‰é’®çš„æ ·å¼é…ç½®ï¼Ÿï¼ˆ`variant`ã€`color`ï¼‰
- [ ] ç­›é€‰æ¡ä»¶çš„çŠ¶æ€ç®¡ç†æ–¹å¼ï¼Ÿ

**å…³äºåˆ—è¡¨åŒºåŸŸ**ï¼š
- [ ] åˆ—è¡¨å¡ç‰‡çš„æ ·å¼é…ç½®ï¼Ÿ
- [ ] å·¥å…·æ çš„å¸ƒå±€æ–¹å¼ï¼Ÿ
- [ ] æŒ‰é’®çš„æ’åˆ—å’Œæ ·å¼ï¼Ÿ
- [ ] è¡¨æ ¼ç»„ä»¶çš„å®Œæ•´é…ç½®ï¼Ÿ
- [ ] è¡¨æ ¼çš„å“åº”å¼æ ·å¼ï¼Ÿï¼ˆ`fontSize`ã€`px`ï¼‰
- [ ] åˆ†é¡µç»„ä»¶çš„ä½ç½®å’Œé…ç½®ï¼Ÿ

**å…³äºæ“ä½œæŒ‰é’®**ï¼š
- [ ] `renderTableActions` å‡½æ•°æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ
- [ ] å¦‚ä½•æ ¹æ®çŠ¶æ€æ§åˆ¶æŒ‰é’®æ˜¾ç¤º/ç¦ç”¨ï¼Ÿ
- [ ] å›¾æ ‡æŒ‰é’®ä½¿ç”¨ä»€ä¹ˆç»„ä»¶ï¼Ÿ
- [ ] `Tooltip` æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼Ÿ

**å…³äºå¯¹è¯æ¡†çŠ¶æ€ç®¡ç†**ï¼š
- [ ] ä½¿ç”¨å“ªäº› `useState` æ¥æ§åˆ¶å¯¹è¯æ¡†ï¼Ÿ
- [ ] å¦‚ä½•æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†ï¼Ÿ
- [ ] å¦‚ä½•ä¼ é€’æ•°æ®ç»™ç¼–è¾‘å¯¹è¯æ¡†ï¼Ÿ
- [ ] å¯¹è¯æ¡†å…³é—­åå¦‚ä½•åˆ·æ–°åˆ—è¡¨ï¼Ÿ

**å…³äºæ•°æ®åŠ è½½**ï¼š
- [ ] æ•°æ®åŠ è½½çš„æ—¶æœºï¼Ÿï¼ˆ`useEffect`ï¼‰
- [ ] Loading çŠ¶æ€å¦‚ä½•æ˜¾ç¤ºï¼Ÿ
- [ ] é”™è¯¯å¤„ç†å¦‚ä½•å®ç°ï¼Ÿ
- [ ] åˆ†é¡µé€»è¾‘å¦‚ä½•å¤„ç†ï¼Ÿ

**è¯·åœ¨ç»ˆç«¯è¾“å‡ºä½ çš„åˆ†æç»“è®º**ï¼Œä¾‹å¦‚ï¼š
```
âœ“ å¤–å±‚å®¹å™¨ä½¿ç”¨ <Box sx={{ width: '100%' }}>
âœ“ é¢åŒ…å±‘ä½¿ç”¨ Breadcrumbs ç»„ä»¶ï¼ŒfontSize: '1.2rem', fontWeight: 600
âœ“ æŸ¥è¯¢å¡ç‰‡ä½¿ç”¨ Paper variant="outlined" sx={{ p: { xs: 1, sm: 2 }, mb: 2 }}
âœ“ Grid å¸ƒå±€ä½¿ç”¨ size={{ xs: 12, md: 6 }} è¯­æ³•
âœ“ æŒ‰é’®ä½¿ç”¨ variant="contained" color="primary" å’Œ variant="outlined"
âœ“ renderTableActions æ ¹æ® package.status åŠ¨æ€è®¾ç½®æŒ‰é’®
...
```

### ä»»åŠ¡2ï¼šåˆ†æç¼–è¾‘å¯¹è¯æ¡†å®ç°

**è¯·è¯»å–å¹¶åˆ†æ**ï¼š

```
frontend/src/components/PackageEditorDialog.tsx
```

**åˆ†æé‡ç‚¹**ï¼š
- [ ] `Dialog` ç»„ä»¶çš„å®Œæ•´é…ç½®ï¼ˆ`open`ã€`onClose`ã€`maxWidth`ã€`fullScreen`ã€`disableEnforceFocus`ï¼‰
- [ ] ç§»åŠ¨ç«¯å…¨å±çš„å®ç°æ–¹å¼ï¼Ÿ
- [ ] `DialogContent` çš„æ»šåŠ¨å®¹å™¨é…ç½®ï¼Ÿ
- [ ] React Hook Form çš„é›†æˆæ–¹å¼ï¼ˆ`useForm`ã€`Controller`ï¼‰
- [ ] è¾…åŠ©æ¸²æŸ“å‡½æ•°çš„ç»„ç»‡æ–¹å¼ï¼ˆæœ‰å“ªäº›å‡½æ•°ï¼Ÿï¼‰
- [ ] è¡¨å•å­—æ®µçš„é…ç½®ï¼ˆ`TextField`ã€`Select`ã€`Autocomplete`ï¼‰
- [ ] Grid å¸ƒå±€çš„å“åº”å¼é…ç½®ï¼Ÿ
- [ ] `DialogActions` çš„æŒ‰é’®é…ç½®ï¼Ÿ
- [ ] è¡¨å•æäº¤é€»è¾‘ï¼ˆ`handleSubmit`ï¼‰
- [ ] é”™è¯¯å¤„ç†å’Œæ˜¾ç¤ºæ–¹å¼ï¼Ÿ

### ä»»åŠ¡3ï¼šåˆ†æ API å®¢æˆ·ç«¯å®ç°

**è¯·è¯»å–å¹¶åˆ†æ**ï¼š

```
frontend/src/api/retail-packages.ts
```

**åˆ†æé‡ç‚¹**ï¼š
- [ ] æ¥å£ç±»å‹çš„å®šä¹‰æ–¹å¼ï¼Ÿ
- [ ] API æ–¹æ³•çš„å‘½åè§„èŒƒï¼Ÿ
- [ ] è¯·æ±‚å’Œå“åº”çš„ç±»å‹æ ‡æ³¨ï¼Ÿ
- [ ] é”™è¯¯å¤„ç†æ¨¡å¼ï¼Ÿ
- [ ] å¯¼å‡ºæ–¹å¼ï¼ˆ`export const` è¿˜æ˜¯ `export default`ï¼‰ï¼Ÿ

---

## ğŸ’» ç¬¬äºŒæ­¥ï¼šå¼€å‘ä»»åŠ¡

### 2.1 åˆ›å»º API å®¢æˆ·ç«¯

**æ–‡ä»¶ä½ç½®**ï¼š`frontend/src/api/retail-contracts.ts`

**è¦æ±‚**ï¼šä¸¥æ ¼å‚è€ƒ `retail-packages.ts` çš„å®ç°æ¨¡å¼

```typescript
import apiClient from './client';

// ç±»å‹å®šä¹‰
export interface Contract {
  _id: string;
  package_name: string;
  package_id: string;
  customer_name: string;
  customer_id: string;
  purchasing_electricity_quantity: number;
  purchase_start_month: string;
  purchase_end_month: string;
  status: 'pending' | 'active' | 'expired';
  created_at: string;
  updated_at: string;
  created_by?: string;
  updated_by?: string;
}

export interface ContractListResponse {
  items: Contract[];
  total: number;
  page: number;
  page_size: number;
}

export interface ContractFormData {
  package_name: string;
  package_id: string;
  customer_name: string;
  customer_id: string;
  purchasing_electricity_quantity: number;
  purchase_start_month: Date | null;
  purchase_end_month: Date | null;
}

// API æ–¹æ³•
export const contractApi = {
  getList: (params?: any) =>
    apiClient.get<ContractListResponse>('/api/v1/retail-contracts', { params }),

  getById: (id: string) =>
    apiClient.get<Contract>(`/api/v1/retail-contracts/${id}`),

  create: (data: Partial<Contract>) =>
    apiClient.post<Contract>('/api/v1/retail-contracts', data),

  update: (id: string, data: Partial<Contract>) =>
    apiClient.put<Contract>(`/api/v1/retail-contracts/${id}`, data),

  delete: (id: string) =>
    apiClient.delete(`/api/v1/retail-contracts/${id}`),

  import: (file: File) => {
    const formData = new FormData();
    formData.append('file', file);
    return apiClient.post('/api/v1/retail-contracts/import', formData, {
      headers: { 'Content-Type': 'multipart/form-data' }
    });
  },

  export: (params?: any) =>
    apiClient.get('/api/v1/retail-contracts/export', {
      params,
      responseType: 'blob'
    })
};
```

### 2.2 åˆ›å»ºåˆåŒåˆ—è¡¨é¡µé¢

**æ–‡ä»¶ä½ç½®**ï¼š`frontend/src/pages/RetailContractPage.tsx`

**å¼ºåˆ¶è¦æ±‚**ï¼š
- å®Œå…¨å‚è€ƒ `RetailPackagePage.tsx` çš„ç»“æ„
- å¤ç”¨æŸ¥è¯¢å¡ç‰‡å’Œåˆ—è¡¨å¡ç‰‡çš„æ ·å¼
- å®ç° `renderTableActions` å‡½æ•°

**æ ¸å¿ƒä»£ç ç»“æ„**ï¼š

```typescript
import React, { useState, useEffect } from 'react';
import {
  Box, Paper, Typography, Breadcrumbs, TextField, Select, MenuItem,
  Button, Table, TableHead, TableBody, TableRow, TableCell,
  TableContainer, TablePagination, IconButton, Tooltip,
  CircularProgress, Alert, Grid
} from '@mui/material';
import VisibilityIcon from '@mui/icons-material/Visibility';
import EditIcon from '@mui/icons-material/Edit';
import DeleteIcon from '@mui/icons-material/Delete';
import { contractApi, Contract } from '../api/retail-contracts';
import ContractEditorDialog from '../components/ContractEditorDialog';
// ... å…¶ä»–å¯¼å…¥

export const RetailContractPage: React.FC = () => {
  // 1. çŠ¶æ€ç®¡ç†
  const [contracts, setContracts] = useState<Contract[]>([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [page, setPage] = useState(0);
  const [pageSize, setPageSize] = useState(10);
  const [total, setTotal] = useState(0);

  // ç­›é€‰æ¡ä»¶
  const [filters, setFilters] = useState({
    package_name: '',
    customer_name: '',
    status: 'all',
  });

  // å¯¹è¯æ¡†çŠ¶æ€
  const [isEditorOpen, setIsEditorOpen] = useState(false);
  const [selectedContract, setSelectedContract] = useState<Contract | null>(null);
  const [editorMode, setEditorMode] = useState<'create' | 'edit'>('create');

  // 2. æ•°æ®åŠ è½½
  const fetchContracts = async () => {
    setLoading(true);
    setError(null);
    try {
      const response = await contractApi.getList({
        ...filters,
        status: filters.status === 'all' ? undefined : filters.status,
        page: page + 1,
        page_size: pageSize
      });
      setContracts(response.data.items);
      setTotal(response.data.total);
    } catch (err: any) {
      setError(err.response?.data?.detail || 'åŠ è½½åˆåŒåˆ—è¡¨å¤±è´¥');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchContracts();
  }, [page, pageSize]);

  // 3. æ“ä½œå¤„ç†
  const handleCreate = () => {
    setSelectedContract(null);
    setEditorMode('create');
    setIsEditorOpen(true);
  };

  const handleEdit = (contract: Contract) => {
    setSelectedContract(contract);
    setEditorMode('edit');
    setIsEditorOpen(true);
  };

  const handleDelete = async (contract: Contract) => {
    // TODO: æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
    // TODO: è°ƒç”¨åˆ é™¤ API
    // TODO: åˆ·æ–°åˆ—è¡¨
  };

  const handleSearch = () => {
    setPage(0);
    fetchContracts();
  };

  const handleReset = () => {
    setFilters({
      package_name: '',
      customer_name: '',
      status: 'all',
    });
    setPage(0);
  };

  // 4. æ¸²æŸ“æ“ä½œæŒ‰é’®ï¼ˆæ ¹æ®çŠ¶æ€æ§åˆ¶ï¼‰
  const renderTableActions = (contract: Contract) => (
    <Box sx={{ display: 'flex', gap: 1 }}>
      <Tooltip title="æŸ¥çœ‹">
        <IconButton size="small" onClick={() => handleView(contract)}>
          <VisibilityIcon fontSize="small" />
        </IconButton>
      </Tooltip>

      {contract.status === 'pending' && (
        <>
          <Tooltip title="ç¼–è¾‘">
            <IconButton size="small" onClick={() => handleEdit(contract)}>
              <EditIcon fontSize="small" />
            </IconButton>
          </Tooltip>

          <Tooltip title="åˆ é™¤">
            <IconButton size="small" onClick={() => handleDelete(contract)}>
              <DeleteIcon fontSize="small" />
            </IconButton>
          </Tooltip>
        </>
      )}
    </Box>
  );

  // 5. UI æ¸²æŸ“
  return (
    <Box sx={{ width: '100%' }}>
      {/* é¢åŒ…å±‘å¯¼èˆª */}
      <Breadcrumbs aria-label="breadcrumb" sx={{ mb: 2 }}>
        <Typography sx={{ fontSize: '1.2rem', fontWeight: 600 }}>
          åˆåŒç®¡ç†
        </Typography>
        <Typography sx={{ fontSize: '1.2rem', fontWeight: 600 }}>
          é›¶å”®åˆåŒ
        </Typography>
      </Breadcrumbs>

      {/* æŸ¥è¯¢åŒºåŸŸ */}
      <Paper variant="outlined" sx={{ p: { xs: 1, sm: 2 }, mb: 2 }}>
        <Grid container spacing={{ xs: 1, sm: 2 }} alignItems="center">
          <Grid size={{ xs: 12, md: 3 }}>
            <TextField
              fullWidth
              size="small"
              label="å¥—é¤åç§°"
              value={filters.package_name}
              onChange={(e) => setFilters({ ...filters, package_name: e.target.value })}
            />
          </Grid>

          <Grid size={{ xs: 12, md: 3 }}>
            <TextField
              fullWidth
              size="small"
              label="å®¢æˆ·åç§°"
              value={filters.customer_name}
              onChange={(e) => setFilters({ ...filters, customer_name: e.target.value })}
            />
          </Grid>

          <Grid size={{ xs: 12, md: 2 }}>
            <Select
              fullWidth
              size="small"
              value={filters.status}
              onChange={(e) => setFilters({ ...filters, status: e.target.value })}
            >
              <MenuItem value="all">æ‰€æœ‰çŠ¶æ€</MenuItem>
              <MenuItem value="pending">å¾…ç”Ÿæ•ˆ</MenuItem>
              <MenuItem value="active">ç”Ÿæ•ˆ</MenuItem>
              <MenuItem value="expired">å·²è¿‡æœŸ</MenuItem>
            </Select>
          </Grid>

          <Grid size={{ xs: 12, md: 4 }}>
            <Box sx={{ display: 'flex', gap: 1 }}>
              <Button
                variant="contained"
                color="primary"
                onClick={handleSearch}
              >
                æŸ¥è¯¢
              </Button>
              <Button
                variant="outlined"
                onClick={handleReset}
              >
                é‡ç½®
              </Button>
            </Box>
          </Grid>
        </Grid>
      </Paper>

      {/* åˆ—è¡¨åŒºåŸŸ */}
      <Paper variant="outlined" sx={{ p: { xs: 1, sm: 2 } }}>
        {/* å·¥å…·æ  */}
        <Box sx={{ mb: 2, display: 'flex', gap: 1 }}>
          <Button
            variant="contained"
            color="primary"
            onClick={handleCreate}
          >
            + æ–°å¢
          </Button>
          <Button
            variant="outlined"
            onClick={() => {/* TODO: æ‰“å¼€å¯¼å…¥å¯¹è¯æ¡† */}}
          >
            å¯¼å…¥
          </Button>
          <Button
            variant="outlined"
            onClick={() => {/* TODO: å¯¼å‡º */}}
          >
            å¯¼å‡º
          </Button>
        </Box>

        {/* æ•°æ®è¡¨æ ¼ */}
        {loading ? (
          <Box sx={{ display: 'flex', justifyContent: 'center', p: 4 }}>
            <CircularProgress />
          </Box>
        ) : error ? (
          <Alert severity="error">{error}</Alert>
        ) : (
          <>
            <TableContainer sx={{ overflowX: 'auto' }}>
              <Table sx={{
                '& .MuiTableCell-root': {
                  fontSize: { xs: '0.75rem', sm: '0.875rem' },
                  px: { xs: 0.5, sm: 2 },
                }
              }}>
                <TableHead>
                  <TableRow>
                    <TableCell>åˆåŒç¼–å·</TableCell>
                    <TableCell>å¥—é¤åç§°</TableCell>
                    <TableCell>å®¢æˆ·åç§°</TableCell>
                    <TableCell>è´­ä¹°ç”µé‡</TableCell>
                    <TableCell>è´­ç”µå¼€å§‹æœˆä»½</TableCell>
                    <TableCell>è´­ç”µç»“æŸæœˆä»½</TableCell>
                    <TableCell>çŠ¶æ€</TableCell>
                    <TableCell>æ“ä½œ</TableCell>
                  </TableRow>
                </TableHead>
                <TableBody>
                  {contracts.map((contract) => (
                    <TableRow key={contract._id}>
                      <TableCell>{contract._id}</TableCell>
                      <TableCell>{contract.package_name}</TableCell>
                      <TableCell>{contract.customer_name}</TableCell>
                      <TableCell>{contract.purchasing_electricity_quantity}</TableCell>
                      <TableCell>{contract.purchase_start_month}</TableCell>
                      <TableCell>{contract.purchase_end_month}</TableCell>
                      <TableCell>{contract.status}</TableCell>
                      <TableCell>{renderTableActions(contract)}</TableCell>
                    </TableRow>
                  ))}
                </TableBody>
              </Table>
            </TableContainer>

            {/* åˆ†é¡µ */}
            <TablePagination
              component="div"
              count={total}
              page={page}
              onPageChange={(e, newPage) => setPage(newPage)}
              rowsPerPage={pageSize}
              onRowsPerPageChange={(e) => {
                setPageSize(parseInt(e.target.value, 10));
                setPage(0);
              }}
              labelRowsPerPage="æ¯é¡µè¡Œæ•°"
            />
          </>
        )}
      </Paper>

      {/* ç¼–è¾‘å¯¹è¯æ¡† */}
      <ContractEditorDialog
        open={isEditorOpen}
        onClose={() => setIsEditorOpen(false)}
        contract={selectedContract}
        mode={editorMode}
        onSuccess={() => {
          setIsEditorOpen(false);
          fetchContracts();
        }}
      />
    </Box>
  );
};

export default RetailContractPage;
```

### 2.3 åˆ›å»ºåˆåŒç¼–è¾‘å¯¹è¯æ¡†

**æ–‡ä»¶ä½ç½®**ï¼š`frontend/src/components/ContractEditorDialog.tsx`

**å¼ºåˆ¶è¦æ±‚**ï¼š
- å®Œå…¨å‚è€ƒ `PackageEditorDialog.tsx` çš„ç»“æ„
- ä½¿ç”¨ React Hook Form
- å®ç°è¾…åŠ©æ¸²æŸ“å‡½æ•°

**æ ¸å¿ƒä»£ç ç»“æ„**ï¼š

```typescript
import React, { useState, useEffect } from 'react';
import {
  Dialog, DialogTitle, DialogContent, DialogActions,
  Button, TextField, Paper, Typography, Grid, Autocomplete
} from '@mui/material';
import { useForm, Controller } from 'react-hook-form';
import { DatePicker, LocalizationProvider } from '@mui/x-date-pickers';
import { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';
import { zhCN } from 'date-fns/locale';
import { contractApi, ContractFormData } from '../api/retail-contracts';
import apiClient from '../api/client';

interface Props {
  open: boolean;
  onClose: () => void;
  contract: Contract | null;
  mode: 'create' | 'edit';
  onSuccess: () => void;
}

export const ContractEditorDialog: React.FC<Props> = ({
  open,
  onClose,
  contract,
  mode,
  onSuccess
}) => {
  // 1. è¡¨å•ç®¡ç†
  const { control, handleSubmit, watch, setValue, reset, formState: { errors } } = useForm<ContractFormData>({
    defaultValues: {
      package_name: '',
      package_id: '',
      customer_name: '',
      customer_id: '',
      purchasing_electricity_quantity: 0,
      purchase_start_month: null,
      purchase_end_month: null
    }
  });

  // 2. å…³è”æ•°æ®åŠ è½½
  const [packageOptions, setPackageOptions] = useState([]);
  const [customerOptions, setCustomerOptions] = useState([]);
  const [selectedPackage, setSelectedPackage] = useState<any>(null);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    if (open) {
      // åŠ è½½å·²ç”Ÿæ•ˆçš„å¥—é¤åˆ—è¡¨
      apiClient.get('/api/v1/retail-packages?status=active')
        .then(res => setPackageOptions(res.data.items || []))
        .catch(err => console.error('åŠ è½½å¥—é¤åˆ—è¡¨å¤±è´¥', err));

      // åŠ è½½æ­£å¸¸çŠ¶æ€çš„å®¢æˆ·åˆ—è¡¨
      apiClient.get('/api/v1/customers?status=active')
        .then(res => setCustomerOptions(res.data.items || []))
        .catch(err => console.error('åŠ è½½å®¢æˆ·åˆ—è¡¨å¤±è´¥', err));

      // å¦‚æœæ˜¯ç¼–è¾‘æ¨¡å¼ï¼Œå¡«å……è¡¨å•
      if (mode === 'edit' && contract) {
        reset({
          package_name: contract.package_name,
          package_id: contract.package_id,
          customer_name: contract.customer_name,
          customer_id: contract.customer_id,
          purchasing_electricity_quantity: contract.purchasing_electricity_quantity,
          purchase_start_month: new Date(contract.purchase_start_month),
          purchase_end_month: new Date(contract.purchase_end_month)
        });
      }
    }
  }, [open, mode, contract]);

  // 3. å¥—é¤é€‰æ‹©ååŠ è½½è¯¦æƒ…
  const handlePackageSelect = async (packageId: string) => {
    try {
      const response = await apiClient.get(`/api/v1/retail-packages/${packageId}`);
      setSelectedPackage(response.data);
    } catch (error) {
      console.error('åŠ è½½å¥—é¤è¯¦æƒ…å¤±è´¥', error);
    }
  };

  // 4. è¡¨å•æäº¤
  const onSubmit = async (data: ContractFormData) => {
    setLoading(true);
    try {
      const submitData = {
        ...data,
        purchase_start_month: data.purchase_start_month?.toISOString(),
        purchase_end_month: data.purchase_end_month?.toISOString()
      };

      if (mode === 'create') {
        await contractApi.create(submitData);
      } else {
        await contractApi.update(contract!._id, submitData);
      }

      onSuccess();
    } catch (error: any) {
      console.error('ä¿å­˜å¤±è´¥', error);
      // TODO: æ˜¾ç¤ºé”™è¯¯æç¤º
    } finally {
      setLoading(false);
    }
  };

  // 5. è¾…åŠ©æ¸²æŸ“å‡½æ•° - åŸºæœ¬ä¿¡æ¯
  const renderBasicInfoSection = () => (
    <Paper variant="outlined" sx={{ p: { xs: 1, sm: 2 }, mt: 2 }}>
      <Typography variant="h6" gutterBottom>åˆåŒåŸºæœ¬ä¿¡æ¯</Typography>

      <Grid container spacing={{ xs: 1, sm: 2 }}>
        {/* å¥—é¤åç§° */}
        <Grid size={{ xs: 12, md: 6 }}>
          <Controller
            name="package_name"
            control={control}
            rules={{ required: 'è¯·é€‰æ‹©å¥—é¤' }}
            render={({ field }) => (
              <Autocomplete
                {...field}
                options={packageOptions}
                getOptionLabel={(option: any) => option.package_name || ''}
                onChange={(event, value) => {
                  field.onChange(value?.package_name || '');
                  setValue('package_id', value?._id || '');
                  if (value) handlePackageSelect(value._id);
                }}
                renderInput={(params) => (
                  <TextField
                    {...params}
                    label="å¥—é¤åç§°"
                    required
                    error={!!errors.package_name}
                    helperText={errors.package_name?.message}
                  />
                )}
              />
            )}
          />
        </Grid>

        {/* å®¢æˆ·åç§° */}
        <Grid size={{ xs: 12, md: 6 }}>
          <Controller
            name="customer_name"
            control={control}
            rules={{ required: 'è¯·é€‰æ‹©å®¢æˆ·' }}
            render={({ field }) => (
              <Autocomplete
                {...field}
                options={customerOptions}
                getOptionLabel={(option: any) => option.user_name || ''}
                onChange={(event, value) => {
                  field.onChange(value?.user_name || '');
                  setValue('customer_id', value?._id || '');
                }}
                renderInput={(params) => (
                  <TextField
                    {...params}
                    label="å®¢æˆ·åç§°"
                    required
                    error={!!errors.customer_name}
                    helperText={errors.customer_name?.message}
                  />
                )}
              />
            )}
          />
        </Grid>

        {/* è´­ä¹°ç”µé‡ */}
        <Grid size={{ xs: 12, md: 6 }}>
          <Controller
            name="purchasing_electricity_quantity"
            control={control}
            rules={{
              required: 'è¯·è¾“å…¥è´­ä¹°ç”µé‡',
              min: { value: 0.01, message: 'è´­ä¹°ç”µé‡å¿…é¡»å¤§äº0' }
            }}
            render={({ field }) => (
              <TextField
                {...field}
                fullWidth
                label="è´­ä¹°ç”µé‡ (kWh)"
                type="number"
                required
                inputProps={{ min: 0, step: 0.01 }}
                error={!!errors.purchasing_electricity_quantity}
                helperText={errors.purchasing_electricity_quantity?.message}
              />
            )}
          />
        </Grid>

        {/* è´­ç”µå¼€å§‹æœˆä»½ */}
        <Grid size={{ xs: 12, md: 6 }}>
          <Controller
            name="purchase_start_month"
            control={control}
            rules={{ required: 'è¯·é€‰æ‹©è´­ç”µå¼€å§‹æœˆä»½' }}
            render={({ field }) => (
              <LocalizationProvider dateAdapter={AdapterDateFns} adapterLocale={zhCN}>
                <DatePicker
                  {...field}
                  label="è´­ç”µå¼€å§‹æœˆä»½"
                  views={['year', 'month']}
                  slotProps={{
                    textField: {
                      fullWidth: true,
                      required: true,
                      error: !!errors.purchase_start_month,
                      helperText: errors.purchase_start_month?.message
                    }
                  }}
                />
              </LocalizationProvider>
            )}
          />
        </Grid>

        {/* è´­ç”µç»“æŸæœˆä»½ */}
        <Grid size={{ xs: 12, md: 6 }}>
          <Controller
            name="purchase_end_month"
            control={control}
            rules={{
              required: 'è¯·é€‰æ‹©è´­ç”µç»“æŸæœˆä»½',
              validate: (value) => {
                const startMonth = watch('purchase_start_month');
                if (startMonth && value && value < startMonth) {
                  return 'è´­ç”µç»“æŸæœˆä»½ä¸èƒ½æ—©äºå¼€å§‹æœˆä»½';
                }
                return true;
              }
            }}
            render={({ field }) => (
              <LocalizationProvider dateAdapter={AdapterDateFns} adapterLocale={zhCN}>
                <DatePicker
                  {...field}
                  label="è´­ç”µç»“æŸæœˆä»½"
                  views={['year', 'month']}
                  slotProps={{
                    textField: {
                      fullWidth: true,
                      required: true,
                      error: !!errors.purchase_end_month,
                      helperText: errors.purchase_end_month?.message
                    }
                  }}
                />
              </LocalizationProvider>
            )}
          />
        </Grid>
      </Grid>
    </Paper>
  );

  // 6. è¾…åŠ©æ¸²æŸ“å‡½æ•° - å¥—é¤å†…å®¹ï¼ˆåªè¯»ï¼‰
  const renderPackageContentSection = () => (
    <Paper variant="outlined" sx={{ p: { xs: 1, sm: 2 }, mt: 2 }}>
      <Typography variant="h6" gutterBottom>å…³è”å¥—é¤å†…å®¹</Typography>

      {selectedPackage ? (
        <Grid container spacing={2}>
          <Grid size={{ xs: 12, sm: 6 }}>
            <Typography variant="body2" color="text.secondary">å¥—é¤ç±»å‹</Typography>
            <Typography variant="body1">
              {selectedPackage.package_type === 'time_based' ? 'åˆ†æ—¶æ®µ' : 'ä¸åˆ†æ—¶æ®µ'}
            </Typography>
          </Grid>

          <Grid size={{ xs: 12, sm: 6 }}>
            <Typography variant="body2" color="text.secondary">å®šä»·æ¨¡å¼</Typography>
            <Typography variant="body1">
              {selectedPackage.pricing_mode === 'fixed_linked' ? 'å›ºå®š+è”åŠ¨' : 'ä»·å·®åˆ†æˆ'}
            </Typography>
          </Grid>

          <Grid size={{ xs: 12, sm: 6 }}>
            <Typography variant="body2" color="text.secondary">æ˜¯å¦ç»¿ç”µ</Typography>
            <Typography variant="body1">
              {selectedPackage.additional_terms?.is_green_energy ? 'æ˜¯' : 'å¦'}
            </Typography>
          </Grid>

          {/* TODO: æ ¹æ®å®é™…å¥—é¤æ•°æ®ç»“æ„å±•ç¤ºæ›´å¤šå­—æ®µ */}
        </Grid>
      ) : (
        <Typography color="text.secondary">è¯·å…ˆé€‰æ‹©å¥—é¤</Typography>
      )}
    </Paper>
  );

  // 7. ä¸»æ¸²æŸ“
  return (
    <Dialog
      open={open}
      onClose={onClose}
      maxWidth="md"
      fullWidth
      fullScreen={window.innerWidth < 600}  // ç§»åŠ¨ç«¯å…¨å±
      disableEnforceFocus
    >
      <DialogTitle>
        {mode === 'create' ? 'æ–°å¢åˆåŒ' : 'ç¼–è¾‘åˆåŒ'}
      </DialogTitle>

      <DialogContent>
        <form id="contract-form" onSubmit={handleSubmit(onSubmit)}>
          {renderBasicInfoSection()}
          {renderPackageContentSection()}
        </form>
      </DialogContent>

      <DialogActions>
        <Button onClick={onClose}>å–æ¶ˆ</Button>
        <Button
          type="submit"
          form="contract-form"
          variant="contained"
          color="primary"
          disabled={loading}
        >
          ä¿å­˜
        </Button>
      </DialogActions>
    </Dialog>
  );
};

export default ContractEditorDialog;
```

### 2.4 æ›´æ–°è·¯ç”±é…ç½®

**æ–‡ä»¶ä½ç½®**ï¼š`frontend/src/App.tsx`

**æ·»åŠ è·¯ç”±**ï¼š

```typescript
import RetailContractPage from './pages/RetailContractPage';
import ProtectedRoute from './components/ProtectedRoute';

// åœ¨è·¯ç”±é…ç½®ä¸­æ·»åŠ 
<Route path="/retail-contracts" element={
  <ProtectedRoute>
    <RetailContractPage />
  </ProtectedRoute>
} />
```

---

## âœ… ç¬¬ä¸‰æ­¥ï¼šéªŒè¯æµ‹è¯•

### 3.1 å¯åŠ¨å‰ç«¯æœåŠ¡

```powershell
# åå°å¯åŠ¨ï¼ˆæ—¥å¿—é‡å®šå‘ï¼‰
Start-Process npm -ArgumentList "start", "--prefix", "frontend" -RedirectStandardOutput "tmp\frontend_dev.log" -RedirectStandardError "tmp\frontend_dev.log"

# ç›‘æ§ç¼–è¯‘é”™è¯¯
cat tmp\frontend_dev.log

# æˆ–è¿è¡Œæ„å»ºæ£€æŸ¥
npm run build --prefix frontend
```

### 3.2 ä½¿ç”¨ Chrome DevTools è°ƒè¯•

**é‡è¦**ï¼šä½¿ç”¨ chrome-devtools MCP å·¥å…·è¿›è¡Œç³»ç»ŸåŒ–æµ‹è¯•

```typescript
// 1. æ‰“å¼€åº”ç”¨å¹¶ç™»å½•
await mcp__chrome-devtools__new_page({ url: 'http://localhost:3000' })
await mcp__chrome-devtools__take_snapshot()

// 2. ç™»å½•ï¼ˆå‡è®¾å·²æœ‰ç™»å½•è¡¨å•ï¼‰
await mcp__chrome-devtools__fill({ uid: 'username-field-uid', value: 'admin' })
await mcp__chrome-devtools__fill({ uid: 'password-field-uid', value: '!234qwer' })
await mcp__chrome-devtools__click({ uid: 'login-button-uid' })

// 3. å¯¼èˆªåˆ°åˆåŒç®¡ç†é¡µé¢
await mcp__chrome-devtools__click({ uid: 'contract-menu-uid' })
await mcp__chrome-devtools__take_snapshot()

// 4. æµ‹è¯•æŸ¥è¯¢åŠŸèƒ½
await mcp__chrome-devtools__fill({ uid: 'package-name-field-uid', value: 'å•†ä¸š' })
await mcp__chrome-devtools__click({ uid: 'search-button-uid' })
await mcp__chrome-devtools__take_snapshot()

// 5. æµ‹è¯•æ–°å¢åŠŸèƒ½
await mcp__chrome-devtools__click({ uid: 'create-button-uid' })
await mcp__chrome-devtools__take_snapshot()

// 6. æ£€æŸ¥æ§åˆ¶å°é”™è¯¯
await mcp__chrome-devtools__list_console_messages({ types: ['error', 'warn'] })
```

### 3.3 åŠŸèƒ½æµ‹è¯•æ¸…å•

**åˆ—è¡¨é¡µé¢æµ‹è¯•**ï¼š
- [ ] é¡µé¢åŠ è½½æ­£å¸¸ï¼Œé¢åŒ…å±‘å¯¼èˆªæ˜¾ç¤º"åˆåŒç®¡ç† > é›¶å”®åˆåŒ"
- [ ] åˆåŒåˆ—è¡¨æ•°æ®æ­£å¸¸æ˜¾ç¤º
- [ ] ç­›é€‰åŠŸèƒ½ï¼š
  - [ ] æŒ‰å¥—é¤åç§°ç­›é€‰æœ‰æ•ˆ
  - [ ] æŒ‰å®¢æˆ·åç§°ç­›é€‰æœ‰æ•ˆ
  - [ ] æŒ‰çŠ¶æ€ç­›é€‰æœ‰æ•ˆï¼ˆæ‰€æœ‰/å¾…ç”Ÿæ•ˆ/ç”Ÿæ•ˆ/å·²è¿‡æœŸï¼‰
- [ ] åˆ†é¡µåŠŸèƒ½ï¼š
  - [ ] åˆ‡æ¢é¡µç æ­£å¸¸
  - [ ] è°ƒæ•´æ¯é¡µæ•°é‡æ­£å¸¸
  - [ ] æ€»æ•°æ˜¾ç¤ºæ­£ç¡®
- [ ] åˆ·æ–°å’Œé‡ç½®æŒ‰é’®åŠŸèƒ½æ­£å¸¸
- [ ] å“åº”å¼è®¾è®¡ï¼š
  - [ ] æ¡Œé¢ç«¯å¸ƒå±€æ­£ç¡®
  - [ ] ç§»åŠ¨ç«¯å¸ƒå±€æ­£ç¡®ï¼ˆå­—æ®µå‚ç›´å †å ï¼‰

**æ“ä½œæŒ‰é’®æµ‹è¯•**ï¼š
- [ ] å¾…ç”Ÿæ•ˆçŠ¶æ€çš„åˆåŒæ˜¾ç¤º"æŸ¥çœ‹"ã€"ç¼–è¾‘"ã€"åˆ é™¤"æŒ‰é’®
- [ ] å·²ç”Ÿæ•ˆçŠ¶æ€çš„åˆåŒä»…æ˜¾ç¤º"æŸ¥çœ‹"æŒ‰é’®
- [ ] å·²è¿‡æœŸçŠ¶æ€çš„åˆåŒä»…æ˜¾ç¤º"æŸ¥çœ‹"æŒ‰é’®
- [ ] æŒ‰é’® Tooltip æ˜¾ç¤ºæ­£ç¡®

**ç¼–è¾‘å¯¹è¯æ¡†æµ‹è¯•ï¼ˆæ–°å¢ï¼‰**ï¼š
- [ ] ç‚¹å‡»"æ–°å¢åˆåŒ"æŒ‰é’®ï¼Œå¯¹è¯æ¡†æ‰“å¼€
- [ ] å¯¹è¯æ¡†æ ‡é¢˜æ˜¾ç¤º"æ–°å¢åˆåŒ"
- [ ] å¥—é¤é€‰æ‹©ä¸‹æ‹‰åˆ—è¡¨ï¼š
  - [ ] åŠ è½½æ­£å¸¸ï¼ˆä»…æ˜¾ç¤ºå·²ç”Ÿæ•ˆå¥—é¤ï¼‰
  - [ ] æ”¯æŒæœç´¢/è¿‡æ»¤
  - [ ] å¯ä»¥æ­£å¸¸é€‰æ‹©
- [ ] å®¢æˆ·é€‰æ‹©ä¸‹æ‹‰åˆ—è¡¨ï¼š
  - [ ] åŠ è½½æ­£å¸¸ï¼ˆä»…æ˜¾ç¤ºæ­£å¸¸çŠ¶æ€å®¢æˆ·ï¼‰
  - [ ] æ”¯æŒæœç´¢/è¿‡æ»¤
  - [ ] å¯ä»¥æ­£å¸¸é€‰æ‹©
- [ ] é€‰æ‹©å¥—é¤åï¼š
  - [ ] å¥—é¤å†…å®¹å¡ç‰‡è‡ªåŠ¨å±•ç¤ºè¯¦æƒ…
  - [ ] å¥—é¤ç±»å‹æ˜¾ç¤ºæ­£ç¡®
  - [ ] å®šä»·æ¨¡å¼æ˜¾ç¤ºæ­£ç¡®
  - [ ] æ˜¯å¦ç»¿ç”µæ˜¾ç¤ºæ­£ç¡®
- [ ] æœˆä»½é€‰æ‹©å™¨ï¼š
  - [ ] ä»…æ˜¾ç¤ºå¹´æœˆé€‰æ‹©
  - [ ] å¯ä»¥æ­£å¸¸é€‰æ‹©
  - [ ] æ ¼å¼æ­£ç¡®
- [ ] è¡¨å•éªŒè¯ï¼š
  - [ ] å¿…å¡«é¡¹æç¤º
  - [ ] è´­ä¹°ç”µé‡>0éªŒè¯
  - [ ] ç»“æŸæœˆä»½>=å¼€å§‹æœˆä»½éªŒè¯
- [ ] ä¿å­˜åŠŸèƒ½ï¼š
  - [ ] ä¿å­˜æˆåŠŸåæ˜¾ç¤ºæˆåŠŸæç¤º
  - [ ] å¯¹è¯æ¡†å…³é—­
  - [ ] åˆ—è¡¨è‡ªåŠ¨åˆ·æ–°
  - [ ] æ–°åˆåŒå‡ºç°åœ¨åˆ—è¡¨ä¸­

**ç¼–è¾‘å¯¹è¯æ¡†æµ‹è¯•ï¼ˆç¼–è¾‘ï¼‰**ï¼š
- [ ] ç‚¹å‡»å¾…ç”Ÿæ•ˆåˆåŒçš„"ç¼–è¾‘"æŒ‰é’®ï¼Œå¯¹è¯æ¡†æ‰“å¼€
- [ ] å¯¹è¯æ¡†æ ‡é¢˜æ˜¾ç¤º"ç¼–è¾‘åˆåŒ"
- [ ] è¡¨å•å­—æ®µè‡ªåŠ¨å¡«å……ç°æœ‰æ•°æ®
- [ ] å¯ä»¥ä¿®æ”¹æ•°æ®
- [ ] ä¿å­˜æˆåŠŸååˆ—è¡¨æ›´æ–°

**ç§»åŠ¨ç«¯æµ‹è¯•**ï¼š
- [ ] å¯¹è¯æ¡†è‡ªåŠ¨åˆ‡æ¢ä¸ºå…¨å±æ¨¡å¼
- [ ] è¡¨å•å­—æ®µå•åˆ—å‚ç›´å¸ƒå±€
- [ ] æ‰€æœ‰æ“ä½œæ­£å¸¸

---

## ğŸ“ éªŒæ”¶æ ‡å‡†

åœ¨å®Œæˆå¼€å‘åï¼Œè¯·é€é¡¹æ£€æŸ¥ï¼š

**åŠŸèƒ½æ€§**ï¼š
- [ ] æ‰€æœ‰åˆ—è¡¨å’Œç¼–è¾‘åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] API è°ƒç”¨æ­£å¸¸ï¼Œæ•°æ®è”åŠ¨æ­£ç¡®
- [ ] æ“ä½œæŒ‰é’®æ ¹æ®çŠ¶æ€æ­£ç¡®æ˜¾ç¤º/éšè—
- [ ] è¡¨å•éªŒè¯å®Œæ•´ä¸”å‡†ç¡®
- [ ] å…³è”æ•°æ®ï¼ˆå¥—é¤ã€å®¢æˆ·ï¼‰åŠ è½½æ­£å¸¸
- [ ] å¥—é¤å†…å®¹è‡ªåŠ¨å±•ç¤ºåŠŸèƒ½æ­£å¸¸

**UI/UX**ï¼š
- [ ] UI ä¸é›¶å”®å¥—é¤æ¨¡å—é«˜åº¦ä¸€è‡´
- [ ] å“åº”å¼è®¾è®¡åœ¨æ‰€æœ‰è®¾å¤‡ä¸Šæ­£å¸¸
- [ ] ç§»åŠ¨ç«¯å…¨å±æ¨¡å¼æ­£å¸¸
- [ ] Loading çŠ¶æ€æç¤ºæ¸…æ™°
- [ ] é”™è¯¯æç¤ºå‹å¥½ä¸”æ˜ç¡®

**ä»£ç è´¨é‡**ï¼š
- [ ] ä½¿ç”¨ TypeScriptï¼Œç±»å‹å®šä¹‰å®Œæ•´
- [ ] ç»„ä»¶å‘½å PascalCase
- [ ] å˜é‡å‡½æ•°ä½¿ç”¨ camelCase
- [ ] Grid ç»„ä»¶ä½¿ç”¨ `size` å±æ€§ï¼ˆMUI v7ï¼‰
- [ ] éµå¾ªé¡¹ç›®å‰ç«¯é¡µé¢è®¾è®¡è§„èŒƒ

**æµ‹è¯•**ï¼š
- [ ] æ—  JavaScript é”™è¯¯æˆ–è­¦å‘Š
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ— æŠ¥é”™
- [ ] ç½‘ç»œè¯·æ±‚æ­£å¸¸ï¼ˆæŸ¥çœ‹ Network é¢æ¿ï¼‰

---

## ğŸš¨ å¸¸è§é—®é¢˜å’Œæ³¨æ„äº‹é¡¹

1. **Grid ç»„ä»¶è¯­æ³•é”™è¯¯**ï¼š
   - âŒ `<Grid item xs={12}>`ï¼ˆMUI v5 è¯­æ³•ï¼‰
   - âœ… `<Grid size={{ xs: 12, md: 6 }}>`ï¼ˆMUI v7 è¯­æ³•ï¼‰

2. **æœˆä»½é€‰æ‹©å™¨é—®é¢˜**ï¼š
   - ç¡®ä¿ä½¿ç”¨ `views={['year', 'month']}`
   - ç¡®ä¿å®‰è£…äº† `@mui/x-date-pickers` å’Œ `date-fns`
   - ç¡®ä¿ä½¿ç”¨ `LocalizationProvider` åŒ…è£¹

3. **Autocomplete ç»„ä»¶é—®é¢˜**ï¼š
   - ç¡®ä¿ `options` æ˜¯æ•°ç»„
   - ç¡®ä¿ `getOptionLabel` è¿”å›å­—ç¬¦ä¸²
   - å¤„ç†ç©ºå€¼æƒ…å†µ

4. **React Hook Form é”™è¯¯**ï¼š
   - ç¡®ä¿ä½¿ç”¨ `Controller` åŒ…è£¹è‡ªå®šä¹‰ç»„ä»¶
   - ç¡®ä¿ `control` æ­£ç¡®ä¼ é€’
   - ç¡®ä¿è¡¨å•æäº¤ä½¿ç”¨ `handleSubmit`

5. **å¯¹è¯æ¡†å…¨å±é—®é¢˜**ï¼š
   - ä½¿ç”¨ `fullScreen={window.innerWidth < 600}`
   - æˆ–ä½¿ç”¨ MUI çš„ `useMediaQuery` Hook

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- **è®¾è®¡æ–¹æ¡ˆç¬¬5èŠ‚**ï¼š`docs/pages/é›¶å”®åˆåŒç®¡ç†/é›¶å”®åˆåŒç®¡ç†æ¨¡å—è®¾è®¡æ–¹æ¡ˆ.md#äº”å‰ç«¯ç»„ä»¶è®¾è®¡`
- **å‰ç«¯é¡µé¢è®¾è®¡è§„èŒƒ**ï¼š`docs/å‰ç«¯é¡µé¢è®¾è®¡è§„èŒƒ.md`
- **CLAUDE.md**ï¼šå‰ç«¯å¼€å‘è§„èŒƒ
- **å‚è€ƒä»£ç **ï¼š
  - `frontend/src/pages/RetailPackagePage.tsx`
  - `frontend/src/components/PackageEditorDialog.tsx`
  - `frontend/src/api/retail-packages.ts`

---

## âœ… å®Œæˆåçš„è¡ŒåŠ¨

åœ¨å®Œæˆæœ¬ä¼šè¯çš„æ‰€æœ‰å¼€å‘å’Œæµ‹è¯•åï¼š

1. æ›´æ–°å¼€å‘è§„åˆ’æ–‡æ¡£ä¸­çš„è¿›åº¦è¡¨
2. æ¸…ç†æ§åˆ¶å°è­¦å‘Šå’Œé”™è¯¯
3. æäº¤ä»£ç åˆ° Gitï¼ˆå¦‚æœé¡¹ç›®ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ï¼‰
4. å‡†å¤‡è¿›å…¥ä¼šè¯4ï¼ˆå‰ç«¯è¯¦æƒ…å’Œå®Œå–„ï¼‰

**ä¼šè¯4æç¤ºè¯**ï¼š`docs/pages/é›¶å”®åˆåŒç®¡ç†/ä¼šè¯4-å‰ç«¯è¯¦æƒ…å®Œå–„æç¤ºè¯.md`
