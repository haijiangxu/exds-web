# é›¶å”®åˆåŒç®¡ç†æ¨¡å— - ä¼šè¯4ï¼šå‰ç«¯è¯¦æƒ…å’Œå®Œå–„

## ğŸ“‹ ä¼šè¯ç›®æ ‡

å®Œæˆé›¶å”®åˆåŒç®¡ç†æ¨¡å—çš„è¯¦æƒ…å¯¹è¯æ¡†ã€å¯¼å…¥å¯¼å‡ºUIã€åˆ é™¤ç¡®è®¤åŠŸèƒ½ï¼Œå¹¶è¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•ã€‚

**é¢„è®¡å·¥æ—¶**ï¼š2-3å°æ—¶

**å‰ç½®æ¡ä»¶**ï¼š
- ä¼šè¯1ã€2ã€3å·²å®Œæˆ
- åˆ—è¡¨å’Œç¼–è¾‘åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- åç«¯æ‰€æœ‰APIæ­£å¸¸è¿è¡Œ

---

## âš ï¸ å¼€å§‹å‰å¿…è¯»

åœ¨ç¼–å†™ä»»ä½•ä»£ç ä¹‹å‰ï¼Œè¯·ç¡®è®¤ï¼š

1. âœ… ä¼šè¯1ã€2ã€3å·²å®Œæˆå¹¶é€šè¿‡æ‰€æœ‰éªŒæ”¶æ ‡å‡†
2. âœ… å‰ç«¯å¼€å‘æœåŠ¡å™¨æ­£å¸¸è¿è¡Œï¼ˆhttp://localhost:3000ï¼‰
3. âœ… åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œï¼ˆhttp://127.0.0.1:8005ï¼‰
4. âœ… å·²é˜…è¯»è®¾è®¡æ–¹æ¡ˆå®Œæ•´å†…å®¹

---

## ğŸ” ç¬¬ä¸€æ­¥ï¼šå¼ºåˆ¶ä»£ç åˆ†æï¼ˆå¿…é¡»å®Œæˆï¼‰

### ä»»åŠ¡1ï¼šåˆ†æè¯¦æƒ…å¯¹è¯æ¡†å®ç°

**è¯·è¯»å–å¹¶åˆ†æ**ï¼š

```
frontend/src/components/PackageDetailsDialog.tsx
```

**åˆ†æé‡ç‚¹**ï¼š
- [ ] `Dialog` ç»„ä»¶çš„é…ç½®ï¼ˆä¸ç¼–è¾‘å¯¹è¯æ¡†æœ‰ä½•ä¸åŒï¼Ÿï¼‰
- [ ] åªè¯»æ•°æ®çš„å±•ç¤ºæ–¹å¼ï¼š
  - ä½¿ç”¨ä»€ä¹ˆç»„ä»¶å±•ç¤ºæ•°æ®ï¼Ÿï¼ˆ`Typography`ï¼Ÿï¼‰
  - "æ ‡ç­¾-å€¼"å¯¹çš„å¸ƒå±€æ–¹å¼ï¼Ÿï¼ˆ`Grid`ï¼Ÿï¼‰
  - æ ·å¼é…ç½®ï¼Ÿï¼ˆå­—ä½“å¤§å°ã€é¢œè‰²ã€é—´è·ï¼‰
- [ ] å¡ç‰‡ç»“æ„ï¼š
  - æ˜¯å¦ä¸ç¼–è¾‘å¯¹è¯æ¡†ä¿æŒä¸€è‡´ï¼Ÿ
  - æ˜¯å¦ä½¿ç”¨ `Paper` ç»„ä»¶ï¼Ÿ
  - æ˜¯å¦æœ‰ç›¸åŒçš„å¡ç‰‡åˆ’åˆ†ï¼Ÿ
- [ ] æ“ä½œæ æŒ‰é’®ï¼š
  - æœ‰å“ªäº›æŒ‰é’®ï¼Ÿ
  - æŒ‰é’®çš„é…ç½®ï¼Ÿï¼ˆ`variant`ã€`color`ï¼‰
  - å¦‚ä½•æ ¹æ®çŠ¶æ€æ§åˆ¶æŒ‰é’®æ˜¾ç¤ºï¼Ÿ
- [ ] æ•°æ®åŠ è½½ï¼š
  - å¦‚ä½•è·å–è¯¦æƒ…æ•°æ®ï¼Ÿ
  - Loading çŠ¶æ€å¦‚ä½•å¤„ç†ï¼Ÿ

**è¯·åœ¨ç»ˆç«¯è¾“å‡ºä½ çš„åˆ†æç»“è®º**

### ä»»åŠ¡2ï¼šåˆ†æåˆ é™¤ç¡®è®¤å¯¹è¯æ¡†

**æ£€æŸ¥é¡¹ç›®ä¸­æ˜¯å¦æœ‰é€šç”¨çš„ç¡®è®¤å¯¹è¯æ¡†ç»„ä»¶**ï¼š

```
frontend/src/components/ConfirmDialog.tsx
frontend/src/components/DeleteConfirmDialog.tsx
```

**åˆ†æé‡ç‚¹**ï¼š
- [ ] å¯¹è¯æ¡†çš„è®¾è®¡æ¨¡å¼
- [ ] å¦‚ä½•ä¼ é€’ç¡®è®¤ä¿¡æ¯
- [ ] å¦‚ä½•å¤„ç†ç¡®è®¤/å–æ¶ˆæ“ä½œ

### ä»»åŠ¡3ï¼šæ£€æŸ¥å¯¼å…¥åŠŸèƒ½çš„å‰ç«¯å®ç°

**æ£€æŸ¥é›¶å”®å¥—é¤æˆ–å®¢æˆ·æ¡£æ¡ˆæ¨¡å—æ˜¯å¦æœ‰å¯¼å…¥åŠŸèƒ½çš„å‰ç«¯å®ç°**ï¼š

```
frontend/src/components/PackageImportDialog.tsx (å¯èƒ½ä¸å­˜åœ¨)
frontend/src/components/CustomerImportDialog.tsx (å¯èƒ½ä¸å­˜åœ¨)
```

---

## ğŸ’» ç¬¬äºŒæ­¥ï¼šå¼€å‘ä»»åŠ¡

### 2.1 åˆ›å»ºåˆåŒè¯¦æƒ…å¯¹è¯æ¡†

**æ–‡ä»¶ä½ç½®**ï¼š`frontend/src/components/ContractDetailsDialog.tsx`

**å¼ºåˆ¶è¦æ±‚**ï¼š
- å®Œå…¨å‚è€ƒ `PackageDetailsDialog.tsx` çš„ç»“æ„
- æ‰€æœ‰è¡¨å•æ§ä»¶æ›¿æ¢ä¸º `Typography` å±•ç¤º
- ä¿æŒå¡ç‰‡ç»“æ„ä¸ç¼–è¾‘å¯¹è¯æ¡†ä¸€è‡´

**æ ¸å¿ƒä»£ç **ï¼š

```typescript
import React, { useEffect, useState } from 'react';
import {
  Dialog, DialogTitle, DialogContent, DialogActions,
  Button, Paper, Typography, Grid, CircularProgress
} from '@mui/material';
import { contractApi, Contract } from '../api/retail-contracts';
import apiClient from '../api/client';

interface Props {
  open: boolean;
  onClose: () => void;
  contractId: string | null;
  onEdit?: (contract: Contract) => void;
}

export const ContractDetailsDialog: React.FC<Props> = ({
  open,
  onClose,
  contractId,
  onEdit
}) => {
  const [contract, setContract] = useState<Contract | null>(null);
  const [packageDetails, setPackageDetails] = useState<any>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  // åŠ è½½åˆåŒè¯¦æƒ…
  useEffect(() => {
    if (open && contractId) {
      setLoading(true);
      setError(null);

      contractApi.getById(contractId)
        .then(res => {
          setContract(res.data);

          // åŠ è½½å…³è”çš„å¥—é¤è¯¦æƒ…
          return apiClient.get(`/api/v1/retail-packages/${res.data.package_id}`);
        })
        .then(res => {
          setPackageDetails(res.data);
        })
        .catch(err => {
          setError(err.response?.data?.detail || 'åŠ è½½å¤±è´¥');
        })
        .finally(() => {
          setLoading(false);
        });
    }
  }, [open, contractId]);

  // æ¸²æŸ“åŸºæœ¬ä¿¡æ¯ï¼ˆåªè¯»ï¼‰
  const renderBasicInfo = () => (
    <Paper variant="outlined" sx={{ p: { xs: 1, sm: 2 }, mt: 2 }}>
      <Typography variant="h6" gutterBottom>åˆåŒåŸºæœ¬ä¿¡æ¯</Typography>

      <Grid container spacing={2}>
        <Grid size={{ xs: 12, sm: 6 }}>
          <Typography variant="body2" color="text.secondary">åˆåŒç¼–å·</Typography>
          <Typography variant="body1">{contract?._id}</Typography>
        </Grid>

        <Grid size={{ xs: 12, sm: 6 }}>
          <Typography variant="body2" color="text.secondary">å¥—é¤åç§°</Typography>
          <Typography variant="body1">{contract?.package_name}</Typography>
        </Grid>

        <Grid size={{ xs: 12, sm: 6 }}>
          <Typography variant="body2" color="text.secondary">å®¢æˆ·åç§°</Typography>
          <Typography variant="body1">{contract?.customer_name}</Typography>
        </Grid>

        <Grid size={{ xs: 12, sm: 6 }}>
          <Typography variant="body2" color="text.secondary">è´­ä¹°ç”µé‡</Typography>
          <Typography variant="body1">
            {contract?.purchasing_electricity_quantity.toLocaleString()} kWh
          </Typography>
        </Grid>

        <Grid size={{ xs: 12, sm: 6 }}>
          <Typography variant="body2" color="text.secondary">è´­ç”µå¼€å§‹æœˆä»½</Typography>
          <Typography variant="body1">
            {contract?.purchase_start_month ? new Date(contract.purchase_start_month).toLocaleDateString('zh-CN', { year: 'numeric', month: 'long' }) : '-'}
          </Typography>
        </Grid>

        <Grid size={{ xs: 12, sm: 6 }}>
          <Typography variant="body2" color="text.secondary">è´­ç”µç»“æŸæœˆä»½</Typography>
          <Typography variant="body1">
            {contract?.purchase_end_month ? new Date(contract.purchase_end_month).toLocaleDateString('zh-CN', { year: 'numeric', month: 'long' }) : '-'}
          </Typography>
        </Grid>

        <Grid size={{ xs: 12, sm: 6 }}>
          <Typography variant="body2" color="text.secondary">åˆåŒçŠ¶æ€</Typography>
          <Typography variant="body1">
            {contract?.status === 'pending' ? 'å¾…ç”Ÿæ•ˆ' : contract?.status === 'active' ? 'ç”Ÿæ•ˆ' : 'å·²è¿‡æœŸ'}
          </Typography>
        </Grid>

        <Grid size={{ xs: 12, sm: 6 }}>
          <Typography variant="body2" color="text.secondary">åˆ›å»ºæ—¶é—´</Typography>
          <Typography variant="body1">
            {contract?.created_at ? new Date(contract.created_at).toLocaleString('zh-CN') : '-'}
          </Typography>
        </Grid>
      </Grid>
    </Paper>
  );

  // æ¸²æŸ“å¥—é¤å†…å®¹ï¼ˆåªè¯»ï¼‰
  const renderPackageContent = () => (
    <Paper variant="outlined" sx={{ p: { xs: 1, sm: 2 }, mt: 2 }}>
      <Typography variant="h6" gutterBottom>å…³è”å¥—é¤å†…å®¹</Typography>

      {packageDetails ? (
        <Grid container spacing={2}>
          <Grid size={{ xs: 12, sm: 6 }}>
            <Typography variant="body2" color="text.secondary">å¥—é¤ç±»å‹</Typography>
            <Typography variant="body1">
              {packageDetails.package_type === 'time_based' ? 'åˆ†æ—¶æ®µ' : 'ä¸åˆ†æ—¶æ®µ'}
            </Typography>
          </Grid>

          <Grid size={{ xs: 12, sm: 6 }}>
            <Typography variant="body2" color="text.secondary">å®šä»·æ¨¡å¼</Typography>
            <Typography variant="body1">
              {packageDetails.pricing_mode === 'fixed_linked' ? 'å›ºå®š+è”åŠ¨' : 'ä»·å·®åˆ†æˆ'}
            </Typography>
          </Grid>

          <Grid size={{ xs: 12, sm: 6 }}>
            <Typography variant="body2" color="text.secondary">æ˜¯å¦ç»¿ç”µ</Typography>
            <Typography variant="body1">
              {packageDetails.additional_terms?.is_green_energy ? 'æ˜¯' : 'å¦'}
            </Typography>
          </Grid>

          {/* TODO: æ ¹æ®å®é™…å¥—é¤æ•°æ®ç»“æ„å±•ç¤ºæ›´å¤šå­—æ®µ */}
        </Grid>
      ) : (
        <Typography color="text.secondary">æ­£åœ¨åŠ è½½å¥—é¤è¯¦æƒ…...</Typography>
      )}
    </Paper>
  );

  return (
    <Dialog
      open={open}
      onClose={onClose}
      maxWidth="md"
      fullWidth
      fullScreen={window.innerWidth < 600}
    >
      <DialogTitle>åˆåŒè¯¦æƒ…</DialogTitle>

      <DialogContent>
        {loading ? (
          <Box sx={{ display: 'flex', justifyContent: 'center', p: 4 }}>
            <CircularProgress />
          </Box>
        ) : error ? (
          <Alert severity="error">{error}</Alert>
        ) : contract ? (
          <>
            {renderBasicInfo()}
            {renderPackageContent()}
          </>
        ) : null}
      </DialogContent>

      <DialogActions>
        {contract?.status === 'pending' && onEdit && (
          <Button
            variant="contained"
            color="primary"
            onClick={() => {
              onEdit(contract);
              onClose();
            }}
          >
            ç¼–è¾‘
          </Button>
        )}
        <Button variant="outlined" onClick={onClose}>
          å…³é—­
        </Button>
      </DialogActions>
    </Dialog>
  );
};

export default ContractDetailsDialog;
```

### 2.2 åˆ›å»ºåˆ é™¤ç¡®è®¤å¯¹è¯æ¡†

**æ–‡ä»¶ä½ç½®**ï¼š`frontend/src/components/DeleteConfirmDialog.tsx`

```typescript
import React from 'react';
import {
  Dialog, DialogTitle, DialogContent, DialogActions,
  Button, Typography
} from '@mui/material';

interface Props {
  open: boolean;
  onClose: () => void;
  onConfirm: () => void;
  title?: string;
  message?: string;
  confirmText?: string;
  cancelText?: string;
}

export const DeleteConfirmDialog: React.FC<Props> = ({
  open,
  onClose,
  onConfirm,
  title = 'ç¡®è®¤åˆ é™¤',
  message = 'ç¡®å®šè¦åˆ é™¤å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚',
  confirmText = 'åˆ é™¤',
  cancelText = 'å–æ¶ˆ'
}) => {
  return (
    <Dialog open={open} onClose={onClose} maxWidth="xs" fullWidth>
      <DialogTitle>{title}</DialogTitle>
      <DialogContent>
        <Typography>{message}</Typography>
      </DialogContent>
      <DialogActions>
        <Button onClick={onClose}>{cancelText}</Button>
        <Button
          onClick={() => {
            onConfirm();
            onClose();
          }}
          color="error"
          variant="contained"
        >
          {confirmText}
        </Button>
      </DialogActions>
    </Dialog>
  );
};

export default DeleteConfirmDialog;
```

### 2.3 åˆ›å»ºå¯¼å…¥å¯¹è¯æ¡†

**æ–‡ä»¶ä½ç½®**ï¼š`frontend/src/components/ContractImportDialog.tsx`

```typescript
import React, { useState } from 'react';
import {
  Dialog, DialogTitle, DialogContent, DialogActions,
  Button, Box, Typography, Alert, Table, TableHead,
  TableBody, TableRow, TableCell, TableContainer, Paper
} from '@mui/material';
import CloudUploadIcon from '@mui/icons-material/CloudUpload';
import { contractApi } from '../api/retail-contracts';

interface Props {
  open: boolean;
  onClose: () => void;
  onSuccess: () => void;
}

interface ImportResult {
  total: number;
  success: number;
  failed: number;
  errors: Array<{ row: number; field: string; message: string }>;
}

export const ContractImportDialog: React.FC<Props> = ({
  open,
  onClose,
  onSuccess
}) => {
  const [selectedFile, setSelectedFile] = useState<File | null>(null);
  const [importing, setImporting] = useState(false);
  const [result, setResult] = useState<ImportResult | null>(null);

  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];
    if (file) {
      setSelectedFile(file);
      setResult(null);
    }
  };

  const handleImport = async () => {
    if (!selectedFile) return;

    setImporting(true);
    try {
      const response = await contractApi.import(selectedFile);
      setResult(response.data);

      // å¦‚æœæœ‰æˆåŠŸå¯¼å…¥çš„è®°å½•ï¼Œé€šçŸ¥çˆ¶ç»„ä»¶åˆ·æ–°åˆ—è¡¨
      if (response.data.success > 0) {
        onSuccess();
      }
    } catch (error: any) {
      console.error('å¯¼å…¥å¤±è´¥', error);
      // TODO: æ˜¾ç¤ºé”™è¯¯æç¤º
    } finally {
      setImporting(false);
    }
  };

  const handleClose = () => {
    setSelectedFile(null);
    setResult(null);
    onClose();
  };

  return (
    <Dialog open={open} onClose={handleClose} maxWidth="md" fullWidth>
      <DialogTitle>å¯¼å…¥åˆåŒæ•°æ®</DialogTitle>

      <DialogContent>
        {/* æ–‡ä»¶é€‰æ‹© */}
        <Box sx={{ mb: 3 }}>
          <Typography variant="body2" color="text.secondary" gutterBottom>
            è¯·é€‰æ‹© Excel æ–‡ä»¶ï¼ˆ.xlsx æˆ– .xlsï¼‰
          </Typography>
          <Typography variant="caption" color="text.secondary" display="block" gutterBottom>
            æ–‡ä»¶å¿…é¡»åŒ…å«ä»¥ä¸‹åˆ—ï¼šå¥—é¤åç§°ã€å®¢æˆ·åç§°ã€è´­ä¹°ç”µé‡ã€è´­ç”µå¼€å§‹æœˆä»½ã€è´­ç”µç»“æŸæœˆä»½
          </Typography>

          <Box sx={{ mt: 2 }}>
            <Button
              component="label"
              variant="outlined"
              startIcon={<CloudUploadIcon />}
            >
              é€‰æ‹©æ–‡ä»¶
              <input
                type="file"
                accept=".xlsx,.xls"
                hidden
                onChange={handleFileSelect}
              />
            </Button>

            {selectedFile && (
              <Typography variant="body2" sx={{ mt: 1 }}>
                å·²é€‰æ‹©ï¼š{selectedFile.name}
              </Typography>
            )}
          </Box>
        </Box>

        {/* å¯¼å…¥ç»“æœ */}
        {result && (
          <Box sx={{ mt: 3 }}>
            <Alert
              severity={result.failed === 0 ? 'success' : result.success > 0 ? 'warning' : 'error'}
              sx={{ mb: 2 }}
            >
              <Typography variant="body2">
                æ€»æ•°ï¼š{result.total} | æˆåŠŸï¼š{result.success} | å¤±è´¥ï¼š{result.failed}
              </Typography>
            </Alert>

            {result.errors.length > 0 && (
              <>
                <Typography variant="subtitle2" gutterBottom>
                  é”™è¯¯è¯¦æƒ…ï¼š
                </Typography>
                <TableContainer component={Paper} variant="outlined">
                  <Table size="small">
                    <TableHead>
                      <TableRow>
                        <TableCell>è¡Œå·</TableCell>
                        <TableCell>å­—æ®µ</TableCell>
                        <TableCell>é”™è¯¯åŸå› </TableCell>
                      </TableRow>
                    </TableHead>
                    <TableBody>
                      {result.errors.map((error, index) => (
                        <TableRow key={index}>
                          <TableCell>{error.row}</TableCell>
                          <TableCell>{error.field}</TableCell>
                          <TableCell>{error.message}</TableCell>
                        </TableRow>
                      ))}
                    </TableBody>
                  </Table>
                </TableContainer>
              </>
            )}
          </Box>
        )}
      </DialogContent>

      <DialogActions>
        <Button onClick={handleClose}>å…³é—­</Button>
        <Button
          onClick={handleImport}
          variant="contained"
          color="primary"
          disabled={!selectedFile || importing}
        >
          {importing ? 'å¯¼å…¥ä¸­...' : 'å¯¼å…¥'}
        </Button>
      </DialogActions>
    </Dialog>
  );
};

export default ContractImportDialog;
```

### 2.4 å®Œå–„åˆ—è¡¨é¡µé¢

**åœ¨ `RetailContractPage.tsx` ä¸­æ·»åŠ **ï¼š

1. **å¯¼å…¥è¯¦æƒ…å¯¹è¯æ¡†å’Œåˆ é™¤ç¡®è®¤å¯¹è¯æ¡†çš„çŠ¶æ€ç®¡ç†**
2. **å®ç°æŸ¥çœ‹ã€åˆ é™¤ã€å¯¼å…¥ã€å¯¼å‡ºåŠŸèƒ½**
3. **æ·»åŠ å…¨å±€ Snackbar åé¦ˆ**

```typescript
// æ·»åŠ çŠ¶æ€
const [isDetailsOpen, setIsDetailsOpen] = useState(false);
const [selectedContractId, setSelectedContractId] = useState<string | null>(null);
const [isImportOpen, setIsImportOpen] = useState(false);
const [isDeleteConfirmOpen, setIsDeleteConfirmOpen] = useState(false);
const [contractToDelete, setContractToDelete] = useState<Contract | null>(null);
const [snackbar, setSnackbar] = useState({ open: false, message: '', severity: 'success' as 'success' | 'error' });

// æŸ¥çœ‹è¯¦æƒ…
const handleView = (contract: Contract) => {
  setSelectedContractId(contract._id);
  setIsDetailsOpen(true);
};

// åˆ é™¤åˆåŒ
const handleDelete = (contract: Contract) => {
  setContractToDelete(contract);
  setIsDeleteConfirmOpen(true);
};

const confirmDelete = async () => {
  if (!contractToDelete) return;

  try {
    await contractApi.delete(contractToDelete._id);
    setSnackbar({ open: true, message: 'åˆ é™¤æˆåŠŸ', severity: 'success' });
    fetchContracts();
  } catch (error: any) {
    setSnackbar({
      open: true,
      message: error.response?.data?.detail || 'åˆ é™¤å¤±è´¥',
      severity: 'error'
    });
  }
};

// å¯¼å‡º
const handleExport = async () => {
  try {
    const response = await contractApi.export({
      ...filters,
      status: filters.status === 'all' ? undefined : filters.status
    });

    const blob = new Blob([response.data], {
      type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
    });
    const url = window.URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `contracts_${new Date().toISOString().slice(0, 10)}.xlsx`;
    link.click();
    window.URL.revokeObjectURL(url);

    setSnackbar({ open: true, message: 'å¯¼å‡ºæˆåŠŸ', severity: 'success' });
  } catch (error: any) {
    setSnackbar({
      open: true,
      message: error.response?.data?.detail || 'å¯¼å‡ºå¤±è´¥',
      severity: 'error'
    });
  }
};

// åœ¨ç»„ä»¶è¿”å›ä¸­æ·»åŠ å¯¹è¯æ¡†å’Œ Snackbar
<ContractDetailsDialog
  open={isDetailsOpen}
  onClose={() => setIsDetailsOpen(false)}
  contractId={selectedContractId}
  onEdit={(contract) => {
    setSelectedContract(contract);
    setEditorMode('edit');
    setIsEditorOpen(true);
  }}
/>

<ContractImportDialog
  open={isImportOpen}
  onClose={() => setIsImportOpen(false)}
  onSuccess={() => {
    setSnackbar({ open: true, message: 'å¯¼å…¥å®Œæˆ', severity: 'success' });
    fetchContracts();
  }}
/>

<DeleteConfirmDialog
  open={isDeleteConfirmOpen}
  onClose={() => setIsDeleteConfirmOpen(false)}
  onConfirm={confirmDelete}
  title="ç¡®è®¤åˆ é™¤åˆåŒ"
  message={`ç¡®å®šè¦åˆ é™¤åˆåŒ"${contractToDelete?.package_name}"å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`}
/>

<Snackbar
  open={snackbar.open}
  autoHideDuration={6000}
  onClose={() => setSnackbar({ ...snackbar, open: false })}
>
  <Alert severity={snackbar.severity} onClose={() => setSnackbar({ ...snackbar, open: false })}>
    {snackbar.message}
  </Alert>
</Snackbar>
```

---

## âœ… ç¬¬ä¸‰æ­¥ï¼šç«¯åˆ°ç«¯æµ‹è¯•

### 3.1 å®Œæ•´åŠŸèƒ½æµ‹è¯•æµç¨‹

**æµ‹è¯•åœºæ™¯1ï¼šåˆ›å»ºåˆåŒå®Œæ•´æµç¨‹**

1. ç™»å½•ç³»ç»Ÿï¼ˆadmin / !234qwerï¼‰
2. å¯¼èˆªåˆ°åˆåŒç®¡ç†é¡µé¢
3. ç‚¹å‡»"æ–°å¢åˆåŒ"
4. é€‰æ‹©å¥—é¤ â†’ éªŒè¯å¥—é¤å†…å®¹è‡ªåŠ¨å±•ç¤º
5. é€‰æ‹©å®¢æˆ·
6. å¡«å†™è´­ä¹°ç”µé‡ã€å¼€å§‹æœˆä»½ã€ç»“æŸæœˆä»½
7. ç‚¹å‡»ä¿å­˜ â†’ éªŒè¯æˆåŠŸæç¤º
8. éªŒè¯åˆåŒå‡ºç°åœ¨åˆ—è¡¨ä¸­ï¼ŒçŠ¶æ€æ­£ç¡®

**æµ‹è¯•åœºæ™¯2ï¼šæŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤**

1. æ‰¾åˆ°å¾…ç”Ÿæ•ˆçŠ¶æ€çš„åˆåŒ
2. ç‚¹å‡»"æŸ¥çœ‹"æŒ‰é’® â†’ éªŒè¯è¯¦æƒ…å¯¹è¯æ¡†å±•ç¤ºå®Œæ•´ä¿¡æ¯
3. åœ¨è¯¦æƒ…å¯¹è¯æ¡†ä¸­ç‚¹å‡»"ç¼–è¾‘" â†’ éªŒè¯æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†
4. ä¿®æ”¹æ•°æ®å¹¶ä¿å­˜ â†’ éªŒè¯æ›´æ–°æˆåŠŸ
5. ç‚¹å‡»"åˆ é™¤"æŒ‰é’® â†’ éªŒè¯äºŒæ¬¡ç¡®è®¤å¯¹è¯æ¡†
6. ç¡®è®¤åˆ é™¤ â†’ éªŒè¯åˆåŒå·²åˆ é™¤

**æµ‹è¯•åœºæ™¯3ï¼šçŠ¶æ€æœºæµ‹è¯•**

1. æ‰¾åˆ°å·²ç”Ÿæ•ˆçŠ¶æ€çš„åˆåŒ
2. éªŒè¯ä»…æ˜¾ç¤º"æŸ¥çœ‹"æŒ‰é’®ï¼Œä¸æ˜¾ç¤º"ç¼–è¾‘"å’Œ"åˆ é™¤"
3. ç‚¹å‡»"æŸ¥çœ‹" â†’ éªŒè¯è¯¦æƒ…å¯¹è¯æ¡†ä¸æ˜¾ç¤º"ç¼–è¾‘"æŒ‰é’®

**æµ‹è¯•åœºæ™¯4ï¼šå¯¼å…¥åŠŸèƒ½**

1. å‡†å¤‡æµ‹è¯• Excel æ–‡ä»¶ï¼ˆåŒ…å«æˆåŠŸå’Œå¤±è´¥çš„æ•°æ®ï¼‰
2. ç‚¹å‡»"å¯¼å…¥"æŒ‰é’®
3. é€‰æ‹©æ–‡ä»¶å¹¶ä¸Šä¼ 
4. éªŒè¯å¯¼å…¥ç»“æœå¯¹è¯æ¡†ï¼š
   - æ˜¾ç¤ºæˆåŠŸ/å¤±è´¥æ•°é‡
   - æ˜¾ç¤ºé”™è¯¯è¯¦æƒ…è¡¨æ ¼
   - é”™è¯¯ä¿¡æ¯æ¸…æ™°ï¼ˆè¡Œå·ã€å­—æ®µã€åŸå› ï¼‰
5. å…³é—­å¯¹è¯æ¡† â†’ éªŒè¯åˆ—è¡¨å·²æ›´æ–°

**æµ‹è¯•åœºæ™¯5ï¼šå¯¼å‡ºåŠŸèƒ½**

1. è®¾ç½®ç­›é€‰æ¡ä»¶ï¼ˆä¾‹å¦‚ï¼šçŠ¶æ€=å¾…ç”Ÿæ•ˆï¼‰
2. ç‚¹å‡»"å¯¼å‡º"æŒ‰é’®
3. éªŒè¯æ–‡ä»¶ä¸‹è½½
4. æ‰“å¼€ Excel æ–‡ä»¶éªŒè¯ï¼š
   - åˆ—åä¸ºä¸­æ–‡
   - æ•°æ®å®Œæ•´å‡†ç¡®
   - æ—¥æœŸæ ¼å¼æ­£ç¡®ï¼ˆYYYY-MMï¼‰
   - çŠ¶æ€æ˜¾ç¤ºä¸ºä¸­æ–‡

### 3.2 å“åº”å¼è®¾è®¡æµ‹è¯•

ä½¿ç”¨ Chrome DevTools æµ‹è¯•ä»¥ä¸‹è®¾å¤‡ï¼š

**ç§»åŠ¨ç«¯**ï¼š
- [ ] iPhone SE (375px å®½)
- [ ] iPhone 12/13 (390px å®½)
- [ ] Galaxy S8 (360px å®½)

**éªŒè¯ç‚¹**ï¼š
- [ ] æŸ¥è¯¢å­—æ®µå‚ç›´å †å 
- [ ] æŒ‰é’®é€‚å½“æ¢è¡Œ
- [ ] è¡¨æ ¼æ¨ªå‘æ»šåŠ¨æ­£å¸¸
- [ ] å¯¹è¯æ¡†å…¨å±æ˜¾ç¤º
- [ ] è¡¨å•å­—æ®µå•åˆ—å¸ƒå±€

**æ¡Œé¢ç«¯**ï¼š
- [ ] 1920x1080
- [ ] 1366x768

**éªŒè¯ç‚¹**ï¼š
- [ ] æŸ¥è¯¢å­—æ®µæ¨ªå‘æ’åˆ—
- [ ] è¡¨æ ¼æ­£å¸¸æ˜¾ç¤º
- [ ] å¯¹è¯æ¡†å±…ä¸­æ˜¾ç¤º
- [ ] è¡¨å•å­—æ®µä¸¤åˆ—å¸ƒå±€

### 3.3 æ€§èƒ½æµ‹è¯•

1. **åˆ—è¡¨åŠ è½½æ€§èƒ½**ï¼š
   - åˆ›å»º 50+ æµ‹è¯•åˆåŒ
   - æµ‹è¯•åˆ—è¡¨åŠ è½½æ—¶é—´
   - éªŒè¯ < 2ç§’

2. **æœç´¢å“åº”æ—¶é—´**ï¼š
   - è¾“å…¥ç­›é€‰æ¡ä»¶å¹¶æœç´¢
   - éªŒè¯å“åº”æ—¶é—´ < 1ç§’

3. **å¤§æ–‡ä»¶å¯¼å…¥æ€§èƒ½**ï¼š
   - å‡†å¤‡ 100 è¡Œæ•°æ®çš„ Excel æ–‡ä»¶
   - æµ‹è¯•å¯¼å…¥æ—¶é—´
   - éªŒè¯ < 15ç§’

### 3.4 å…¼å®¹æ€§æµ‹è¯•

- [ ] Chrome æµè§ˆå™¨å®Œæ•´åŠŸèƒ½æµ‹è¯•
- [ ] Firefox æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
- [ ] Safari æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•ï¼ˆå¦‚å¯ç”¨ï¼‰
- [ ] Edge æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•

---

## ğŸ“ æœ€ç»ˆéªŒæ”¶æ ‡å‡†

### åŠŸèƒ½æ€§
- [ ] æ‰€æœ‰ CRUD æ“ä½œæ­£å¸¸å·¥ä½œ
- [ ] å¯¼å…¥å¯¼å‡ºåŠŸèƒ½æ­£å¸¸
- [ ] çŠ¶æ€æœºæƒé™æ§åˆ¶æœ‰æ•ˆ
- [ ] æ•°æ®å…³è”æ­£ç¡®ï¼ˆå¥—é¤ã€å®¢æˆ·ï¼‰
- [ ] è™šæ‹ŸçŠ¶æ€è®¡ç®—å‡†ç¡®

### UI/UX
- [ ] UI ä¸é›¶å”®å¥—é¤ã€å®¢æˆ·æ¡£æ¡ˆæ¨¡å—é«˜åº¦ä¸€è‡´
- [ ] å“åº”å¼è®¾è®¡åœ¨æ‰€æœ‰è®¾å¤‡ä¸Šæ­£å¸¸
- [ ] Loading çŠ¶æ€æç¤ºæ¸…æ™°
- [ ] é”™è¯¯æç¤ºå‹å¥½ä¸”æ˜ç¡®
- [ ] æ“ä½œåé¦ˆåŠæ—¶ï¼ˆSnackbarï¼‰
- [ ] åˆ é™¤ç­‰å±é™©æ“ä½œæœ‰äºŒæ¬¡ç¡®è®¤

### ä»£ç è´¨é‡
- [ ] æ—  TypeScript é”™è¯¯
- [ ] æ—  ESLint è­¦å‘Š
- [ ] ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒ
- [ ] ç»„ä»¶å‘½åè§„èŒƒ
- [ ] ç±»å‹å®šä¹‰å®Œæ•´

### æ€§èƒ½
- [ ] API å“åº”æ—¶é—´ < 2ç§’
- [ ] åˆ—è¡¨åŠ è½½æµç•…
- [ ] ç§»åŠ¨ç«¯ä½“éªŒæµç•…
- [ ] å¤§æ–‡ä»¶å¯¼å…¥å¯æ¥å—ï¼ˆ100è¡Œ < 15ç§’ï¼‰

### æµ‹è¯•
- [ ] æ—  JavaScript é”™è¯¯æˆ–è­¦å‘Š
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ— æŠ¥é”™
- [ ] ç½‘ç»œè¯·æ±‚æ­£å¸¸
- [ ] æ‰€æœ‰æµ‹è¯•åœºæ™¯é€šè¿‡

---

## ğŸš¨ å¸¸è§é—®é¢˜å’Œæ³¨æ„äº‹é¡¹

1. **è¯¦æƒ…å¯¹è¯æ¡†æ•°æ®åŠ è½½é—®é¢˜**ï¼š
   - ç¡®ä¿åœ¨ `useEffect` ä¸­æ£€æŸ¥ `open` å’Œ `contractId`
   - å¤„ç† Loading å’Œ Error çŠ¶æ€
   - å…³è”æ•°æ®ï¼ˆå¥—é¤è¯¦æƒ…ï¼‰éœ€è¦å•ç‹¬åŠ è½½

2. **æ–‡ä»¶ä¸‹è½½é—®é¢˜**ï¼š
   - ç¡®ä¿ä½¿ç”¨ `Blob` å’Œ `createObjectURL`
   - ä¸‹è½½åè®°å¾— `revokeObjectURL`
   - æ–‡ä»¶ååŒ…å«æ—¶é—´æˆ³é¿å…è¦†ç›–

3. **åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†**ï¼š
   - ç¡®ä¿ä¼ é€’æ­£ç¡®çš„åˆåŒä¿¡æ¯
   - åˆ é™¤æˆåŠŸååˆ·æ–°åˆ—è¡¨
   - å¤„ç†åˆ é™¤å¤±è´¥çš„æƒ…å†µ

4. **Snackbar æ˜¾ç¤ºé—®é¢˜**ï¼š
   - ç¡®ä¿ `autoHideDuration` è¶³å¤Ÿé•¿
   - æä¾›å…³é—­æŒ‰é’®
   - ä¸åŒç±»å‹ä½¿ç”¨ä¸åŒ severity

5. **ç§»åŠ¨ç«¯å…¨å±å¯¹è¯æ¡†**ï¼š
   - ä½¿ç”¨ `useMediaQuery` æˆ–ç›´æ¥åˆ¤æ–­ `window.innerWidth`
   - ç¡®ä¿æ‰€æœ‰å¯¹è¯æ¡†éƒ½æ”¯æŒç§»åŠ¨ç«¯å…¨å±

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- **è®¾è®¡æ–¹æ¡ˆ**ï¼š`docs/pages/é›¶å”®åˆåŒç®¡ç†/é›¶å”®åˆåŒç®¡ç†æ¨¡å—è®¾è®¡æ–¹æ¡ˆ.md`
- **å¼€å‘è§„åˆ’ä¼šè¯4**ï¼š`docs/pages/é›¶å”®åˆåŒç®¡ç†/é›¶å”®åˆåŒç®¡ç†æ¨¡å—å¼€å‘è§„åˆ’.md#ä¼šè¯-4å‰ç«¯è¯¦æƒ…å’Œå®Œå–„`
- **å‰ç«¯é¡µé¢è®¾è®¡è§„èŒƒ**ï¼š`docs/å‰ç«¯é¡µé¢è®¾è®¡è§„èŒƒ.md`
- **å‚è€ƒä»£ç **ï¼š
  - `frontend/src/components/PackageDetailsDialog.tsx`
  - `frontend/src/pages/RetailPackagePage.tsx`

---

## âœ… å®Œæˆåçš„è¡ŒåŠ¨

åœ¨å®Œæˆæœ¬ä¼šè¯çš„æ‰€æœ‰å¼€å‘å’Œæµ‹è¯•åï¼š

1. **æ›´æ–°å¼€å‘è§„åˆ’æ–‡æ¡£**ï¼š
   - æ ‡è®°æ‰€æœ‰ä¼šè¯ä¸º"å·²å®Œæˆ"
   - å¡«å†™å®Œæˆæ—¥æœŸå’Œæµ‹è¯•ç»“æœ

2. **æ¸…ç†ä»£ç **ï¼š
   - ç§»é™¤æ‰€æœ‰ console.log
   - ç§»é™¤æœªä½¿ç”¨çš„å¯¼å…¥
   - æ ¼å¼åŒ–æ‰€æœ‰ä»£ç 

3. **æäº¤ä»£ç **ï¼š
   ```bash
   git add .
   git commit -m "å®Œæˆé›¶å”®åˆåŒç®¡ç†æ¨¡å—

   - åç«¯ï¼šCRUD APIã€å¯¼å…¥å¯¼å‡ºã€çŠ¶æ€æœº
   - å‰ç«¯ï¼šåˆ—è¡¨ã€ç¼–è¾‘ã€è¯¦æƒ…ã€å¯¼å…¥å¯¼å‡ºUI
   - æµ‹è¯•ï¼šé€šè¿‡æ‰€æœ‰éªŒæ”¶æ ‡å‡†"
   git push
   ```

4. **ç”Ÿæˆæ–‡æ¡£**ï¼š
   - æ›´æ–° API æ–‡æ¡£ï¼ˆå¦‚éœ€è¦ï¼‰
   - åˆ›å»ºç”¨æˆ·æ“ä½œæ‰‹å†Œï¼ˆå¦‚éœ€è¦ï¼‰

5. **é¡¹ç›®æ€»ç»“**ï¼š
   - è®°å½•é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
   - æ€»ç»“å¯å¤ç”¨çš„ä»£ç æ¨¡å¼
   - æå‡ºä¼˜åŒ–å»ºè®®

---

## ğŸ‰ æ­å–œå®Œæˆï¼

é›¶å”®åˆåŒç®¡ç†æ¨¡å—å·²å…¨éƒ¨å¼€å‘å®Œæˆã€‚æ­¤æ¨¡å—ä¸é›¶å”®å¥—é¤ç®¡ç†ã€å®¢æˆ·æ¡£æ¡ˆç®¡ç†æ¨¡å—ä¿æŒäº†é«˜åº¦ä¸€è‡´çš„ä»£ç æ¶æ„å’Œç”¨æˆ·ä½“éªŒï¼Œä¸ºåç»­æ¨¡å—å¼€å‘æ ‘ç«‹äº†è‰¯å¥½çš„èŒƒä¾‹ã€‚
