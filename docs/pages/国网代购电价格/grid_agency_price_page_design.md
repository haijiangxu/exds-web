# 国网代购电价格页面设计方案

本文档详细描述了“国网代购电价格”页面的最终前端实现方案，旨在为开发提供清晰的指引。

## 1. 整体布局与风格

-   **页面标题**: 页面顶部将显示一个统一的大标题：“国网代购电价格”。
-   **布局结构**: 页面内容将遵循“**卡片 -> 图表 -> 表格**”的经典看板布局，为用户提供从宏观概览到微观细节的流畅分析体验。
-   **风格一致性**: 整个页面的开发将严格遵循项目已有的 `Material-UI` 主题（`theme.ts`），包括颜色、字体、间距等，确保与现有页面的视觉风格完全统一。
-   **移动端支持 (响应式设计)**: 所有组件都将采用响应式设计，确保在手机等小屏幕设备上也能获得良好的浏览和操作体验。

## 2. 指标卡片区 (最终设计)

页面顶部将包含一组核心指标卡片，用于直观展示最新月份的核心数据。卡片将布局在一个响应式的 `Grid` 容器中。

### 卡片一：代理购电价格构成 (主卡片)

-   **设计目的**: 突出显示最终结算价格，并清晰展示其核心构成。
-   **主指标**: 以最大号字体突出显示 **代理购电价格 (`purchase_price`)**。
-   **支撑指标**: 在主指标下方，以稍小的字体并列展示其两个核心构成部分：
    -   `平均上网电价: [avg_on_grid_price] 元/kWh`
    -   `历史偏差折价: [historical_deviation_discount] 元/kWh`

### 卡片二与卡片三 (组合布局)

-   **设计目的**: 为优化排版，将两个关联度较低但体量较小的指标并排摆放，整体与其他大卡片等宽。
-   **卡片二 (左侧)**: **代理购电规模**，显示 `purchase_scale_kwh` (单位将处理为 **万kWh**)。
-   **卡片三 (右侧)**: **上网环节线损**，显示 `network_loss_price` (单位: 元/kWh)。

### 卡片四：系统运行费及构成 (详情卡片)

-   **设计目的**: 展示系统运行费的总额，并提供其详细的构成明细。
-   **主指标**: 正常字体大小显示 **系统运行费 (`system_op_cost_discount`)** 的总额。
-   **构成明细**: 在总额下方，将以列表形式，用**小号字体**清晰地展示其7个组成部分（对应数据源中 `price_composition` 数组的第9至15项）及其数值，例如：
    -   辅助服务费用折价: [数值]
    -   抽水蓄能容量电费折价: [数值]
    -   ...等等。

## 3. 历史趋势图表区

-   **技术选型**: 使用 `Recharts` 库的复合图表 (`ComposedChart`)。
-   **图表内容**:
    -   **折线图 (`Line`)**: 用于展示 `purchase_price`, `avg_on_grid_price` 等多项**价格指标**的历史趋势。
    -   **柱状图 (`Bar`)**: 用于展示 `purchase_scale_kwh`（**购电规模**）的历史变化。
-   **响应式**: 图表将被包裹在 `ResponsiveContainer` 中，以实现对不同屏幕尺寸的自动适应。

## 4. 历史数据表格区

-   **技术选型**: 采用 `Material-UI` 的 `<DataGrid>` 组件，以利用其内置的排序、筛选和分页功能。
-   **分页要求**: 表格将进行分页处理，设置**默认每页显示 10 条**记录。当总记录数超过10时，表格下方将自动显示分页控件。
-   **交互功能**: 表格最后一列将设置“操作”列，内含“查看公告”按钮。点击该按钮将调用后端API，在新标签页中打开并展示与该行数据对应的原始PDF公告文件。

## 5. 后端API与路由

-   **数据API**: 创建 `GET /api/v1/prices/sgcc` 端点，用于查询并返回 `price_sgcc` 集合中的所有历史数据（不含PDF二进制内容）。
-   **文件API**: 创建 `GET /api/v1/prices/sgcc/{month}/pdf` 端点，用于根据月份ID获取并返回PDF文件流。
-   **前端路由**: 更新 `App.tsx` 中的路由配置，将路径 `/basic-data/grid-price` 指向本方案所设计的新页面组件。
